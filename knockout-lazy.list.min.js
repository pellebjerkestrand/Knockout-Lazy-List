(function(e,t,n){var r={getScroll:function(){var t="onwheel"in e||e.documentMode>=9?"wheel":e.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";return{init:function(e,n){e.addEventListener(t,n(),false)}}}};var i={horizontalConfiguration:{eventDirection:"pageX",parentEdge:"left",offset:"offsetWidth",scrubberProperty:"left"},verticalConfiguration:{eventDirection:"pageY",parentEdge:"top",offset:"offsetHeight",scrubberProperty:"top"},getScrubber:function(n){n=n||i.verticalConfiguration;return{init:function(r,i){var s=i(),o=s.percentage||function(){};r.onmousedown=function(){t(e.body).addClass("no-select");e.onmousemove=function(e){o((e[n.eventDirection]-r.parentNode.getBoundingClientRect()[n.parentEdge]-r[n.offset]/2)/r.parentNode[n.offset])};e.onmouseup=function(){t(e.body).removeClass("no-select");e.onmousemove=e.onmouseup=null}}},update:function(e,r){var i=r(),s=i.on||0,o=i.max||0;t(e).css(n.scrubberProperty,s/o*100+"%")}}}};var s={getControlPanel:function(e){function i(e){var i=this,s=e.controls||[],o=e.filterTopic||"LLFT",u=e.comparatorTopic||"LLCT";i.panels=s;i.getComparator=function(e,t){if(t===r.ascending){return function(t,n){if(t[e].toLowerCase()[0]<n[e].toLowerCase()[0]){return-1}if(t[e].toLowerCase()[0]>n[e].toLowerCase()[0]){return 1}return 0}}else if(t===r.descending){return function(t,n){if(t[e].toLowerCase()[0]>n[e].toLowerCase()[0]){return-1}if(t[e].toLowerCase()[0]<n[e].toLowerCase()[0]){return 1}return 0}}return function(){return 0}};i.comparatorHandler=function(e){n.postbox.publish(u,i.getComparator(e.propertyName,e.type))};i.getFilters=function(){var e=[],n=[];for(var r=0;r<i.panels.length;r++){var s=i.panels[r].actions;for(var o=0;o<s.length;o++){var u=s[o];if(u.type===t.text){var a=u.filter();if(a.length>0){(function(t,n){e.push(function(e){return e[t].toLowerCase().indexOf(n)!=-1})})(u.propertyName,a)}}else if(u.type===t.filter&&u.active()){(function(e,t){n.push(function(n){return n[e].toLowerCase()===t.toLowerCase()})})(u.propertyName,u.propertyValue)}}}if(n.length>0){var f=function(e){var t=false;for(var r=0;r<n.length;r++){t=n[r](e);if(t){break}}return t};e.push(f)}return e};i.filterHandler=function(){n.postbox.publish(o,i.getFilters())};i.freeTextFilterHandler=i.filterHandler;i.fixedFilterHandler=i.filterHandler;for(var a=0;a<i.panels.length;a++){var f=i.panels[a].actions;for(var l=0;l<f.length;l++){var c=f[l];if(c.type===t.text){c.filter=n.observable("").extend({rateLimit:300});c.filter.subscribe(i.filterHandler)}else if(c.type===t.filter){c.active=n.observable(true);c.active.subscribe(i.filterHandler)}}}}var t={text:"freeTextFilter",ascending:"alphabeticalAscendingSort",descending:"alphabeticalDescendingSort",filter:"fixedFilter"},r={ascending:"alphabeticalAscendingSort",descending:"alphabeticalDescendingSort"};return new i(e)}};var o={states:{initial:"initial",error:"error",loading:"loading",success:"success"},horizontalModel:function(e,r,i,s,u,a){var f=this;f.visibleData=n.computed(function(){var t=e(),n=r(),s=[];for(var o=0;o<n.length;o++){s.push(n[o].days.slice(t,t+i()))}return s});f.headers=n.observableArray([]);f.visibleHeaders=n.computed(function(){var t=e();return f.headers().slice(t,t+i())});f.visibleGroups=n.computed(function(){var e=f.visibleHeaders()||[],t=[],n=0,r="",i=1,s=true;for(var o=0;o<e.length;o++){var u=e[o].month;if(s){t.push({title:u,columns:i});s=false}else{if(r===u){i++;t[n].columns=i}else{i=1;n++;t.push({title:u,columns:i})}}r=u}return t});f.getNumberOfDays=n.computed(function(){var e=u()[0];return e&&Array.isArray(e.days)?e.days.length:0});f.max=n.computed(function(){var e=f.getNumberOfDays()-i();return e<0?0:e});f.init=function(){t.ajax({url:a,type:"get",beforeSend:function(){s(o.states.loading)},success:function(e){f.headers(e.headers);u(e.data);s(o.states.success)},error:function(){s(o.states.error)}})}},verticalModel:function(e,r,i,s,u,a){var f=this;f.visible=n.computed(function(){var t=e();return r().slice(t,t+i())});f.max=n.computed(function(){var e=r().length-i();return e<0?0:e});f.init=function(){t.ajax({url:a,type:"get",beforeSend:function(){s(o.states.loading)},success:function(e){u(e);s(o.states.success)},error:function(){s(o.states.error)}})}},baseModel:function(e,t){function r(e,t){var r=this,i=t.pageSize||30,s=t.filterTopic||"LLFT",u=t.comparatorTopic||"LLCT";r.on=n.observable(0);r.state=n.observable(o.states.initial);r.pageSize=n.observable(i);r.data=n.observableArray([]);r.filters=n.observableArray([]).subscribeTo(s);r.comparator=n.observable(null).subscribeTo(u);r.processed=n.computed(function(){var e=r.data(),t=r.filters(),n=e;t=t.filter(function(e){return typeof e==="function"});for(var i=0;i<t.length;i++){n=n.filter(t[i])}var s=r.comparator(),o=n;if(typeof s==="function"){o=o.sort(s)}r.on(0);return o});n.utils.extend(r,new e(r.on,r.processed,r.pageSize,r.state,r.data,t.endpoint));r.percentage=n.computed({read:function(){return this.on()/this.max()*100+"%"},write:function(e){var t=this.max();this.on(Math.max(Math.min(Math.round(t*e),t),0))},owner:r});r.onWheel=function(e){var t=r.on(),n=r.max(),i=0,s=e.deltaY||e.detail||e.wheelDeltaY;if(e.webkitDirectionInvertedFromDevice){s=-s}if(s<0){i=t+1}else{i=t-1}if(i>-1&&i<=n){r.on(i);e.preventDefault()}};if(typeof r["init"]==="function"){r.init()}}return new r(e,t)},getList:function(e,t){return o.baseModel(e,t)}};n.bindingHandlers.scroll=r.getScroll();n.bindingHandlers.lazyScrubberHorizontal=i.getScrubber(i.horizontalConfiguration);n.bindingHandlers.lazyScrubberVertical=i.getScrubber(i.verticalConfiguration);t(function(){t("[data-lazy-list-control-panel]").each(function(){n.applyBindings(s.getControlPanel(t(this).data("lazy-list-control-panel")),this)});t("[data-lazy-list-horizontal]").each(function(){n.applyBindings(o.getList(o.horizontalModel,t(this).data("lazy-list-horizontal")),this)});t("[data-lazy-list-vertical]").each(function(){n.applyBindings(o.getList(o.verticalModel,t(this).data("lazy-list-vertical")),this)})})})(document,jQuery,ko)