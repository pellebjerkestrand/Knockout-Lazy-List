<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Knockout Lazy List</title>
    <script src="jquery-1.11.1.js"></script>
    <script src="knockout-3.1.0.debug.js"></script>
    <script src="knockout-postbox.js"></script>
    <script src="knockout.bindinghandler.scroll.js"></script>
    <script src="knockout.bindinghandler.lazy.scrubber.vertical.js"></script>
    <script src="knockout.lazy.list.vertical.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script>
        $(function(){
            var reverse = false;

            $('[data-sort]').on('click', function(){
                var comp = function(){
                    return 0;
                };

                if(reverse){
                    comp = function(a,b){
                        if(a.name.toLowerCase()[0] > b.name.toLowerCase()[0]){
                            return -1;
                        }

                        if(a.name.toLowerCase()[0] < b.name.toLowerCase()[0]){
                            return 1;
                        }

                        return 0;
                    };
                } else {
                    comp = function(a,b){
                        if(a.name.toLowerCase()[0] < b.name.toLowerCase()[0]){
                            return -1;
                        }

                        if(a.name.toLowerCase()[0] > b.name.toLowerCase()[0]){
                            return 1;
                        }

                        return 0;
                    };
                }

                reverse = !reverse;

                ko.postbox.publish('LLCT', comp);
            });

            var filter = true;

            $('[data-filter]').on('click', function(){
                if(filter){
                    ko.postbox.publish('LLFT', [
                        function(value, index, array){
                            return value.name.toLowerCase().indexOf('a') != -1;
                        },
                        function(value, index, array){
                            return value.name.toLowerCase().indexOf('b') != -1;
                        },
                        function(value, index, array){
                            return value.name.toLowerCase().indexOf('c') != -1;
                        }
                    ]);
                } else {
                    ko.postbox.publish('LLFT', []);
                }

                filter = !filter;
            });
        });
    </script>
</head>
<body>
<div>
    <div>
        <button type="button" data-sort>Sort</button>
        <button type="button" data-filter>Filter</button>
    </div>
    <div data-lazy-list-vertical='{ "endpoint": "5k.json", "pageSize": 30 }'>
        <div>
            Showing <span data-bind="text: visible().length"></span> of <span data-bind="text: processed().length"></span>, total: <span data-bind="text: data().length"></span>
        </div>
        <div class="lazy-wrapper">
            <table class="lazy">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Guid</th>
                    <th>Email</th>
                    <th>Phone</th>
                </tr>
                </thead>
                <tbody data-bind="foreach: visible, scroll: onWheel">
                <tr>
                    <td data-bind="text: name"></td>
                    <td data-bind="text: guid"></td>
                    <td data-bind="text: email"></td>
                    <td data-bind="text: phone"></td>
                </tr>
                </tbody>
            </table>
            <div class="track">
                <div class="track-inner">
                    <div class="track-scrubber" data-bind="lazyScrubberVertical: { percentage: percentage, on: on(), max: max() }">
                        <span class="text">Scrubber</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>